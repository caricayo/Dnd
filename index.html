<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>D&D AI GM</title>
    <link rel="stylesheet" href="./style.css" />
  </head>
  <body>
    <header class="app-header">
      <div class="left">
        <h1>üó∫Ô∏è D&D AI GM</h1>
        <div id="api-status" class="status" title="API status" aria-live="polite">
          <span class="dot" id="api-dot"></span>
          <span id="api-text">Checking‚Ä¶</span>
        </div>
      </div>
      <div class="right">
        <button id="new-session" title="Start a new campaign" type="button">New Campaign</button>
        <button id="save-session" title="Save this session" type="button">Save</button>
      </div>
    </header>

    <main class="layout">
      <aside class="sidebar">
        <h2>Saved Sessions</h2>
        <ul id="session-list"></ul>
      </aside>

      <section class="content">
        <div class="image-panel">
          <img id="scene-image" alt="Generated scene will appear here" />
          <div class="image-controls">
            <button id="gen-image" type="button">üé® Generate Scene</button>
            <select id="image-size">
              <option value="1024x1024">1024√ó1024 (square)</option>
              <option value="1024x1536">1024√ó1536 (portrait)</option>
              <option value="1536x1024">1536√ó1024 (landscape)</option>
              <option value="auto">Auto</option>
            </select>
            <!-- NEW: clear image button -->
            <button id="clear-image" type="button" title="Clear the current scene">üßπ Clear</button>
          </div>
        </div>

        <div class="chat-panel">
          <div id="messages" class="messages" aria-live="polite"></div>

          <div class="composer">
            <textarea id="input" rows="2" placeholder="Say something to your Game Master‚Ä¶"></textarea>
            <div class="row">
              <button id="send" type="button">Send</button>
              <button id="mute-mic" aria-pressed="true" title="Toggle microphone" type="button">üé§ On</button>
              <button id="tts-toggle" title="Speak the last reply" type="button">üîà Speak</button>
              <select id="tts-provider" title="TTS provider">
                <option value="webspeech">Web Speech (browser)</option>
                <option value="custom">Custom HTTP (set below)</option>
              </select>
              <input id="tts-url" placeholder="Custom TTS endpoint (POST) returning audio/* e.g. https://your-worker/tts" />
            </div>
          </div>
        </div>
      </section>
    </main>

    <footer class="app-footer">
      <label>Proxy URL:
        <input id="proxy-url" size="40" autocomplete="off" spellcheck="false"
          placeholder="https://dnd-openai-proxy.yourname.workers.dev" />
      </label>
      <label>Model:
        <select id="model">
          <option value="gpt-4o-mini" selected>GPT-4 (Mini)</option>
          <option value="gpt-4o">GPT-4 (4o)</option>
          <option value="gpt-5">GPT-5</option>
        </select>
      </label>
      <label>System prompt:
        <input id="system-prompt" size="60"
          value="You are a cinematic, fair D&D Game Master. It‚Äôs a sandbox. Defer to the player‚Äôs setup and house rules. Keep turns brisk and descriptive." />
      </label>
    </footer>

    <script type="module" src="./app.js"></script>
  </body>
</html>
